get_geocoding <- function(address, ak = NULL) {
  require(rjson)
  require(RCurl)
  
  if (is.null(ak) | ak == "") cat("请输入百度地图API密钥！")
  
  else {
    strurl <- paste0(
      "https://api.map.baidu.com/geocoding/v3/?",
      "address=",address,"&ak=",ak,
      "&ret_coordtype=gcj02ll&output=json"
    )
    
    res.json <- getURL(
      strurl,ssl.verifypeer = FALSE,
      curl = getCurlHandle(),.encoding = "UTF-8"
    )
    
    res.list <- fromJSON(json_str = res.json)
    
    if (res.list$status == 0 && length(res.list$result) > 0) {
      return(
        data.frame(
          address = address,
          lat = res.list$result$location$lat,
          lng = res.list$result$location$lng,
          precise = res.list$result$precise,
          confidence = res.list$result$confidence,
          level = res.list$result$level,
          stringsAsFactors = FALSE
        )
      )
    } else {
      return(
        data.frame(
          address = character(),
          lat = numeric(),
          lng = numeric(),
          precise = numeric(),
          confidence = numeric(),
          level = character(),
          stringsAsFactors = FALSE
        )
      )
    }
  }
}

# get_geocoding(address = '南京大学',ak = 'fZX5Hqp90BkYudg2cESQp9AwrapFCfme')
